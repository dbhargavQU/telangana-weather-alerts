/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tweet/trigger/route";
exports.ids = ["app/api/tweet/trigger/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftweet%2Ftrigger%2Froute&page=%2Fapi%2Ftweet%2Ftrigger%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftweet%2Ftrigger%2Froute.ts&appDir=%2FUsers%2Fmohithdonthu%2FWeatherman%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohithdonthu%2FWeatherman&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftweet%2Ftrigger%2Froute&page=%2Fapi%2Ftweet%2Ftrigger%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftweet%2Ftrigger%2Froute.ts&appDir=%2FUsers%2Fmohithdonthu%2FWeatherman%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohithdonthu%2FWeatherman&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mohithdonthu_Weatherman_app_api_tweet_trigger_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/tweet/trigger/route.ts */ \"(rsc)/./app/api/tweet/trigger/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tweet/trigger/route\",\n        pathname: \"/api/tweet/trigger\",\n        filename: \"route\",\n        bundlePath: \"app/api/tweet/trigger/route\"\n    },\n    resolvedPagePath: \"/Users/mohithdonthu/Weatherman/app/api/tweet/trigger/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mohithdonthu_Weatherman_app_api_tweet_trigger_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZ0d2VldCUyRnRyaWdnZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnR3ZWV0JTJGdHJpZ2dlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnR3ZWV0JTJGdHJpZ2dlciUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1vaGl0aGRvbnRodSUyRldlYXRoZXJtYW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbW9oaXRoZG9udGh1JTJGV2VhdGhlcm1hbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDYTtBQUMxRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWxhbmdhbmEtd2VhdGhlci1saXZlLz9mOTBmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvbW9oaXRoZG9udGh1L1dlYXRoZXJtYW4vYXBwL2FwaS90d2VldC90cmlnZ2VyL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90d2VldC90cmlnZ2VyL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdHdlZXQvdHJpZ2dlclwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdHdlZXQvdHJpZ2dlci9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9tb2hpdGhkb250aHUvV2VhdGhlcm1hbi9hcHAvYXBpL3R3ZWV0L3RyaWdnZXIvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftweet%2Ftrigger%2Froute&page=%2Fapi%2Ftweet%2Ftrigger%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftweet%2Ftrigger%2Froute.ts&appDir=%2FUsers%2Fmohithdonthu%2FWeatherman%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohithdonthu%2FWeatherman&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/api/tweet/trigger/route.ts":
/*!****************************************!*\
  !*** ./app/api/tweet/trigger/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/redis */ \"(rsc)/./lib/redis.ts\");\n/* harmony import */ var _jobs_tweetRunner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/jobs/tweetRunner */ \"(rsc)/./jobs/tweetRunner.ts\");\n\n\n\nconst LOCK_KEY = 'tweet:trigger:lock';\nlet lastTriggerAtMs = null;\nasync function POST(req) {\n    const body = await req.json().catch(()=>({}));\n    const areaId = body?.areaId;\n    // Try Redis rate-limit; fall back to in-memory if Redis unavailable\n    try {\n        const set = await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.set(LOCK_KEY, String(Date.now()), 'NX', 'EX', 60);\n        if (set !== 'OK') {\n            const ttl = await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.ttl(LOCK_KEY);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: false,\n                error: `Try again in ${ttl}s`\n            });\n        }\n    } catch  {\n        const now = Date.now();\n        if (lastTriggerAtMs && now - lastTriggerAtMs < 60000) {\n            const wait = Math.ceil((60000 - (now - lastTriggerAtMs)) / 1000);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: false,\n                error: `Try again in ${wait}s`\n            });\n        }\n        lastTriggerAtMs = now;\n    }\n    const result = await (0,_jobs_tweetRunner__WEBPACK_IMPORTED_MODULE_2__.runTweetRunner)(areaId ? [\n        areaId\n    ] : undefined);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        ok: true,\n        ...result\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3R3ZWV0L3RyaWdnZXIvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUNwQjtBQUNnQjtBQUVwRCxNQUFNRyxXQUFXO0FBQ2pCLElBQUlDLGtCQUFpQztBQUU5QixlQUFlQyxLQUFLQyxHQUFnQjtJQUN6QyxNQUFNQyxPQUFPLE1BQU1ELElBQUlFLElBQUksR0FBR0MsS0FBSyxDQUFDLElBQU8sRUFBQztJQUM1QyxNQUFNQyxTQUE2QkgsTUFBTUc7SUFDekMsb0VBQW9FO0lBQ3BFLElBQUk7UUFDRixNQUFNQyxNQUFNLE1BQU1WLDZDQUFLQSxDQUFDVSxHQUFHLENBQUNSLFVBQVVTLE9BQU9DLEtBQUtDLEdBQUcsS0FBSyxNQUFNLE1BQU07UUFDdEUsSUFBSUgsUUFBUSxNQUFNO1lBQ2hCLE1BQU1JLE1BQU0sTUFBTWQsNkNBQUtBLENBQUNjLEdBQUcsQ0FBQ1o7WUFDNUIsT0FBT0gscURBQVlBLENBQUNRLElBQUksQ0FBQztnQkFBRVEsSUFBSTtnQkFBT0MsT0FBTyxDQUFDLGFBQWEsRUFBRUYsSUFBSSxDQUFDLENBQUM7WUFBQztRQUN0RTtJQUNGLEVBQUUsT0FBTTtRQUNOLE1BQU1ELE1BQU1ELEtBQUtDLEdBQUc7UUFDcEIsSUFBSVYsbUJBQW1CVSxNQUFNVixrQkFBa0IsT0FBUTtZQUNyRCxNQUFNYyxPQUFPQyxLQUFLQyxJQUFJLENBQUMsQ0FBQyxRQUFVTixDQUFBQSxNQUFNVixlQUFjLENBQUMsSUFBSztZQUM1RCxPQUFPSixxREFBWUEsQ0FBQ1EsSUFBSSxDQUFDO2dCQUFFUSxJQUFJO2dCQUFPQyxPQUFPLENBQUMsYUFBYSxFQUFFQyxLQUFLLENBQUMsQ0FBQztZQUFDO1FBQ3ZFO1FBQ0FkLGtCQUFrQlU7SUFDcEI7SUFDQSxNQUFNTyxTQUFTLE1BQU1uQixpRUFBY0EsQ0FBQ1EsU0FBUztRQUFDQTtLQUFPLEdBQUdZO0lBQ3hELE9BQU90QixxREFBWUEsQ0FBQ1EsSUFBSSxDQUFDO1FBQUVRLElBQUk7UUFBTSxHQUFHSyxNQUFNO0lBQUM7QUFDakQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWxhbmdhbmEtd2VhdGhlci1saXZlLy4vYXBwL2FwaS90d2VldC90cmlnZ2VyL3JvdXRlLnRzPzMxNWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IHJlZGlzIH0gZnJvbSAnQC9saWIvcmVkaXMnO1xuaW1wb3J0IHsgcnVuVHdlZXRSdW5uZXIgfSBmcm9tICdAL2pvYnMvdHdlZXRSdW5uZXInO1xuXG5jb25zdCBMT0NLX0tFWSA9ICd0d2VldDp0cmlnZ2VyOmxvY2snO1xubGV0IGxhc3RUcmlnZ2VyQXRNczogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gIGNvbnN0IGFyZWFJZDogc3RyaW5nIHwgdW5kZWZpbmVkID0gYm9keT8uYXJlYUlkO1xuICAvLyBUcnkgUmVkaXMgcmF0ZS1saW1pdDsgZmFsbCBiYWNrIHRvIGluLW1lbW9yeSBpZiBSZWRpcyB1bmF2YWlsYWJsZVxuICB0cnkge1xuICAgIGNvbnN0IHNldCA9IGF3YWl0IHJlZGlzLnNldChMT0NLX0tFWSwgU3RyaW5nKERhdGUubm93KCkpLCAnTlgnLCAnRVgnLCA2MCk7XG4gICAgaWYgKHNldCAhPT0gJ09LJykge1xuICAgICAgY29uc3QgdHRsID0gYXdhaXQgcmVkaXMudHRsKExPQ0tfS0VZKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IGBUcnkgYWdhaW4gaW4gJHt0dGx9c2AgfSk7XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChsYXN0VHJpZ2dlckF0TXMgJiYgbm93IC0gbGFzdFRyaWdnZXJBdE1zIDwgNjBfMDAwKSB7XG4gICAgICBjb25zdCB3YWl0ID0gTWF0aC5jZWlsKCg2MF8wMDAgLSAobm93IC0gbGFzdFRyaWdnZXJBdE1zKSkgLyAxMDAwKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiBmYWxzZSwgZXJyb3I6IGBUcnkgYWdhaW4gaW4gJHt3YWl0fXNgIH0pO1xuICAgIH1cbiAgICBsYXN0VHJpZ2dlckF0TXMgPSBub3c7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcnVuVHdlZXRSdW5uZXIoYXJlYUlkID8gW2FyZWFJZF0gOiB1bmRlZmluZWQpO1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBvazogdHJ1ZSwgLi4ucmVzdWx0IH0pO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJyZWRpcyIsInJ1blR3ZWV0UnVubmVyIiwiTE9DS19LRVkiLCJsYXN0VHJpZ2dlckF0TXMiLCJQT1NUIiwicmVxIiwiYm9keSIsImpzb24iLCJjYXRjaCIsImFyZWFJZCIsInNldCIsIlN0cmluZyIsIkRhdGUiLCJub3ciLCJ0dGwiLCJvayIsImVycm9yIiwid2FpdCIsIk1hdGgiLCJjZWlsIiwicmVzdWx0IiwidW5kZWZpbmVkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/tweet/trigger/route.ts\n");

/***/ }),

/***/ "(rsc)/./jobs/tweetDecider.ts":
/*!******************************!*\
  !*** ./jobs/tweetDecider.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decideTweets: () => (/* binding */ decideTweets)\n/* harmony export */ });\n/* harmony import */ var _lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/tweetRules */ \"(rsc)/./lib/tweetRules.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/redis */ \"(rsc)/./lib/redis.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./lib/config.ts\");\n\n\n\n\nasync function decideTweets(areaIds) {\n    const areas = areaIds?.length ? await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.area.findMany({\n        where: {\n            id: {\n                in: areaIds\n            }\n        }\n    }) : await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.area.findMany();\n    const picks = [];\n    for (const a of areas){\n        const res = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000'}/api/areas/${a.id}`, {\n            cache: 'no-store'\n        });\n        const data = await res.json();\n        const now = data?.now;\n        const today = data?.today;\n        const week = data?.week;\n        // NOW\n        if ((0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.shouldTweetNow)(now)) {\n            const bucket = (now?.intensityWordNow || 'now').toLowerCase();\n            const hash = (0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.makeHash)(a.id, 'now', bucket, now?.radarEtaMin ? `${now.radarEtaMin.from}-${now.radarEtaMin.to}` : '');\n            const ok = await allowTweet(hash);\n            if (ok) picks.push({\n                areaId: a.id,\n                scope: 'now',\n                bucket,\n                windowLabel: now?.radarEtaMin ? `${now.radarEtaMin.from}-${now.radarEtaMin.to}` : null\n            });\n        }\n        // TODAY\n        if ((0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.shouldTweetToday)(today)) {\n            const bucket = (today?.intensityWordToday || 'today').toLowerCase();\n            const hash = (0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.makeHash)(a.id, 'today', bucket, today?.windowLabel || '');\n            const ok = await allowTweet(hash);\n            if (ok) picks.push({\n                areaId: a.id,\n                scope: 'today',\n                bucket,\n                windowLabel: today?.windowLabel || null\n            });\n        }\n        // WEEK\n        if ((0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.shouldTweetWeek)(week)) {\n            const top = (week || []).find((d)=>d.mmHigh >= 15);\n            const bucket = top ? new Date(top.date).toLocaleDateString('en-IN', {\n                timeZone: 'Asia/Kolkata',\n                weekday: 'short'\n            }) : 'week';\n            const hash = (0,_lib_tweetRules__WEBPACK_IMPORTED_MODULE_0__.makeHash)(a.id, 'week', bucket, 'week');\n            const ok = await allowTweet(hash);\n            if (ok) picks.push({\n                areaId: a.id,\n                scope: 'week',\n                bucket,\n                windowLabel: 'week'\n            });\n        }\n    }\n    return picks;\n}\nasync function allowTweet(hash) {\n    const key = `tweet:hash:${hash}`;\n    const exists = await _lib_redis__WEBPACK_IMPORTED_MODULE_2__.redis.get(key);\n    if (exists) return false;\n    await _lib_redis__WEBPACK_IMPORTED_MODULE_2__.redis.set(key, '1', 'EX', _lib_config__WEBPACK_IMPORTED_MODULE_3__.config.tweetMinGapMin * 60);\n    const dayKey = `tweet:budget:${new Date().toISOString().slice(0, 10)}`;\n    const count = await _lib_redis__WEBPACK_IMPORTED_MODULE_2__.redis.incr(dayKey);\n    if (count === 1) await _lib_redis__WEBPACK_IMPORTED_MODULE_2__.redis.expire(dayKey, 24 * 60 * 60);\n    if (count > _lib_config__WEBPACK_IMPORTED_MODULE_3__.config.tweetDailyBudget) return false;\n    return true;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sQ0FBQyxXQUFXLEVBQUVwQixNQUFNO0lBQ2hDLE1BQU1xQixTQUFTLE1BQU1oRCw2Q0FBS0EsQ0FBQ2lELEdBQUcsQ0FBQ0Y7SUFDL0IsSUFBSUMsUUFBUSxPQUFPO0lBQ25CLE1BQU1oRCw2Q0FBS0EsQ0FBQ2tELEdBQUcsQ0FBQ0gsS0FBSyxLQUFLLE1BQU05QywrQ0FBTUEsQ0FBQ2tELGNBQWMsR0FBRztJQUN4RCxNQUFNQyxTQUFTLENBQUMsYUFBYSxFQUFFLElBQUlWLE9BQU9XLFdBQVcsR0FBR0MsS0FBSyxDQUFDLEdBQUcsS0FBSztJQUN0RSxNQUFNQyxRQUFRLE1BQU12RCw2Q0FBS0EsQ0FBQ3dELElBQUksQ0FBQ0o7SUFDL0IsSUFBSUcsVUFBVSxHQUFHLE1BQU12RCw2Q0FBS0EsQ0FBQ3lELE1BQU0sQ0FBQ0wsUUFBUSxLQUFLLEtBQUs7SUFDdEQsSUFBSUcsUUFBUXRELCtDQUFNQSxDQUFDeUQsZ0JBQWdCLEVBQUUsT0FBTztJQUM1QyxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWxhbmdhbmEtd2VhdGhlci1saXZlLy4vam9icy90d2VldERlY2lkZXIudHM/ZTg0MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzaG91bGRUd2VldE5vdywgc2hvdWxkVHdlZXRUb2RheSwgc2hvdWxkVHdlZXRXZWVrLCBtYWtlSGFzaCwgdHlwZSBTY29wZSB9IGZyb20gJ0AvbGliL3R3ZWV0UnVsZXMnO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvZGInO1xuaW1wb3J0IHsgcmVkaXMgfSBmcm9tICdAL2xpYi9yZWRpcyc7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICdAL2xpYi9jb25maWcnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVjaWRlVHdlZXRzKGFyZWFJZHM/OiBzdHJpbmdbXSk6IFByb21pc2U8XG4gIEFycmF5PHsgYXJlYUlkOiBzdHJpbmc7IHNjb3BlOiBTY29wZTsgYnVja2V0OiBzdHJpbmc7IHdpbmRvd0xhYmVsOiBzdHJpbmcgfCBudWxsIH0+XG4+IHtcbiAgY29uc3QgYXJlYXMgPSBhcmVhSWRzPy5sZW5ndGggPyBhd2FpdCBwcmlzbWEuYXJlYS5maW5kTWFueSh7IHdoZXJlOiB7IGlkOiB7IGluOiBhcmVhSWRzIH0gfSB9KSA6IGF3YWl0IHByaXNtYS5hcmVhLmZpbmRNYW55KCk7XG4gIGNvbnN0IHBpY2tzOiBBcnJheTx7IGFyZWFJZDogc3RyaW5nOyBzY29wZTogU2NvcGU7IGJ1Y2tldDogc3RyaW5nOyB3aW5kb3dMYWJlbDogc3RyaW5nIHwgbnVsbCB9PiA9IFtdO1xuICBmb3IgKGNvbnN0IGEgb2YgYXJlYXMpIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ30vYXBpL2FyZWFzLyR7YS5pZH1gLCB7IGNhY2hlOiAnbm8tc3RvcmUnIH0pO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpO1xuICAgIGNvbnN0IG5vdyA9IGRhdGE/Lm5vdztcbiAgICBjb25zdCB0b2RheSA9IGRhdGE/LnRvZGF5O1xuICAgIGNvbnN0IHdlZWsgPSBkYXRhPy53ZWVrO1xuICAgIC8vIE5PV1xuICAgIGlmIChzaG91bGRUd2VldE5vdyhub3cpKSB7XG4gICAgICBjb25zdCBidWNrZXQgPSAobm93Py5pbnRlbnNpdHlXb3JkTm93IHx8ICdub3cnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgY29uc3QgaGFzaCA9IG1ha2VIYXNoKGEuaWQsICdub3cnLCBidWNrZXQsIG5vdz8ucmFkYXJFdGFNaW4gPyBgJHtub3cucmFkYXJFdGFNaW4uZnJvbX0tJHtub3cucmFkYXJFdGFNaW4udG99YCA6ICcnKTtcbiAgICAgIGNvbnN0IG9rID0gYXdhaXQgYWxsb3dUd2VldChoYXNoKTtcbiAgICAgIGlmIChvaykgcGlja3MucHVzaCh7IGFyZWFJZDogYS5pZCwgc2NvcGU6ICdub3cnLCBidWNrZXQsIHdpbmRvd0xhYmVsOiBub3c/LnJhZGFyRXRhTWluID8gYCR7bm93LnJhZGFyRXRhTWluLmZyb219LSR7bm93LnJhZGFyRXRhTWluLnRvfWAgOiBudWxsIH0pO1xuICAgIH1cbiAgICAvLyBUT0RBWVxuICAgIGlmIChzaG91bGRUd2VldFRvZGF5KHRvZGF5KSkge1xuICAgICAgY29uc3QgYnVja2V0ID0gKHRvZGF5Py5pbnRlbnNpdHlXb3JkVG9kYXkgfHwgJ3RvZGF5JykudG9Mb3dlckNhc2UoKTtcbiAgICAgIGNvbnN0IGhhc2ggPSBtYWtlSGFzaChhLmlkLCAndG9kYXknLCBidWNrZXQsIHRvZGF5Py53aW5kb3dMYWJlbCB8fCAnJyk7XG4gICAgICBjb25zdCBvayA9IGF3YWl0IGFsbG93VHdlZXQoaGFzaCk7XG4gICAgICBpZiAob2spIHBpY2tzLnB1c2goeyBhcmVhSWQ6IGEuaWQsIHNjb3BlOiAndG9kYXknLCBidWNrZXQsIHdpbmRvd0xhYmVsOiB0b2RheT8ud2luZG93TGFiZWwgfHwgbnVsbCB9KTtcbiAgICB9XG4gICAgLy8gV0VFS1xuICAgIGlmIChzaG91bGRUd2VldFdlZWsod2VlaykpIHtcbiAgICAgIGNvbnN0IHRvcCA9ICh3ZWVrIHx8IFtdKS5maW5kKChkOiBhbnkpID0+IGQubW1IaWdoID49IDE1KTtcbiAgICAgIGNvbnN0IGJ1Y2tldCA9IHRvcCA/IG5ldyBEYXRlKHRvcC5kYXRlKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUlOJywgeyB0aW1lWm9uZTogJ0FzaWEvS29sa2F0YScsIHdlZWtkYXk6ICdzaG9ydCcgfSkgOiAnd2Vlayc7XG4gICAgICBjb25zdCBoYXNoID0gbWFrZUhhc2goYS5pZCwgJ3dlZWsnLCBidWNrZXQsICd3ZWVrJyk7XG4gICAgICBjb25zdCBvayA9IGF3YWl0IGFsbG93VHdlZXQoaGFzaCk7XG4gICAgICBpZiAob2spIHBpY2tzLnB1c2goeyBhcmVhSWQ6IGEuaWQsIHNjb3BlOiAnd2VlaycsIGJ1Y2tldCwgd2luZG93TGFiZWw6ICd3ZWVrJyB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBpY2tzO1xufVxuXG5hc3luYyBmdW5jdGlvbiBhbGxvd1R3ZWV0KGhhc2g6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBrZXkgPSBgdHdlZXQ6aGFzaDoke2hhc2h9YDtcbiAgY29uc3QgZXhpc3RzID0gYXdhaXQgcmVkaXMuZ2V0KGtleSk7XG4gIGlmIChleGlzdHMpIHJldHVybiBmYWxzZTtcbiAgYXdhaXQgcmVkaXMuc2V0KGtleSwgJzEnLCAnRVgnLCBjb25maWcudHdlZXRNaW5HYXBNaW4gKiA2MCk7XG4gIGNvbnN0IGRheUtleSA9IGB0d2VldDpidWRnZXQ6JHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApfWA7XG4gIGNvbnN0IGNvdW50ID0gYXdhaXQgcmVkaXMuaW5jcihkYXlLZXkpO1xuICBpZiAoY291bnQgPT09IDEpIGF3YWl0IHJlZGlzLmV4cGlyZShkYXlLZXksIDI0ICogNjAgKiA2MCk7XG4gIGlmIChjb3VudCA+IGNvbmZpZy50d2VldERhaWx5QnVkZ2V0KSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB0cnVlO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJzaG91bGRUd2VldE5vdyIsInNob3VsZFR3ZWV0VG9kYXkiLCJzaG91bGRUd2VldFdlZWsiLCJtYWtlSGFzaCIsInByaXNtYSIsInJlZGlzIiwiY29uZmlnIiwiZGVjaWRlVHdlZXRzIiwiYXJlYUlkcyIsImFyZWFzIiwibGVuZ3RoIiwiYXJlYSIsImZpbmRNYW55Iiwid2hlcmUiLCJpZCIsImluIiwicGlja3MiLCJhIiwicmVzIiwiZmV0Y2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJjYWNoZSIsImRhdGEiLCJqc29uIiwibm93IiwidG9kYXkiLCJ3ZWVrIiwiYnVja2V0IiwiaW50ZW5zaXR5V29yZE5vdyIsInRvTG93ZXJDYXNlIiwiaGFzaCIsInJhZGFyRXRhTWluIiwiZnJvbSIsInRvIiwib2siLCJhbGxvd1R3ZWV0IiwicHVzaCIsImFyZWFJZCIsInNjb3BlIiwid2luZG93TGFiZWwiLCJpbnRlbnNpdHlXb3JkVG9kYXkiLCJ0b3AiLCJmaW5kIiwiZCIsIm1tSGlnaCIsIkRhdGUiLCJkYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwidGltZVpvbmUiLCJ3ZWVrZGF5Iiwia2V5IiwiZXhpc3RzIiwiZ2V0Iiwic2V0IiwidHdlZXRNaW5HYXBNaW4iLCJkYXlLZXkiLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwiY291bnQiLCJpbmNyIiwiZXhwaXJlIiwidHdlZXREYWlseUJ1ZGdldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./jobs/tweetDecider.ts\n");

/***/ }),

/***/ "(rsc)/./jobs/tweetRunner.ts":
/*!*****************************!*\
  !*** ./jobs/tweetRunner.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   runTweetRunner: () => (/* binding */ runTweetRunner)\n/* harmony export */ });\n/* harmony import */ var _jobs_tweetDecider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/jobs/tweetDecider */ \"(rsc)/./jobs/tweetDecider.ts\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./lib/config.ts\");\n/* harmony import */ var _lib_xClient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/xClient */ \"(rsc)/./lib/xClient.ts\");\n/* harmony import */ var _lib_tweetFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/tweetFormat */ \"(rsc)/./lib/tweetFormat.ts\");\n\n\n\n\n\nasync function runTweetRunner(areaIds) {\n    if (!_lib_config__WEBPACK_IMPORTED_MODULE_2__.config.tweetEnable) return {\n        posted: 0,\n        skipped: 'disabled'\n    };\n    const picks = await (0,_jobs_tweetDecider__WEBPACK_IMPORTED_MODULE_0__.decideTweets)(areaIds);\n    let posted = 0;\n    for (const p of picks){\n        const a = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.area.findUnique({\n            where: {\n                id: p.areaId\n            }\n        });\n        if (!a) continue;\n        const res = await fetch(`${process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000'}/api/areas/${a.id}`, {\n            cache: 'no-store'\n        });\n        const data = await res.json();\n        const isHyd = /Hyderabad/i.test(a.name);\n        // Build input text for AI\n        const input = [\n            `AREA: ${a.name}`,\n            `WHEN_LOCAL: ${p.windowLabel || data?.today?.windowLabel || ''} IST`,\n            `NOW: eta=${data?.now?.radarEtaMin ? `${data.now.radarEtaMin.from}-${data.now.radarEtaMin.to}` : 'none'}; mmh=${data?.now ? `${data.now.mmhLow}-${data.now.mmhHigh}` : 'none'}; thunder=${data?.now?.thunderFlag ? 'true' : 'false'}`,\n            `TODAY: total3h=${data?.today ? `${data.today.threeMmLow}-${data.today.threeMmHigh} mm` : 'none'}; intensity=${data?.today?.intensityWordToday || 'none'}; prob=${data?.today?.maxProb12h ?? 0}%`,\n            `WEEK_TOP2: ${(data?.week || []).slice(0, 2).map((d)=>`${new Date(d.date).toLocaleDateString('en-IN', {\n                    timeZone: 'Asia/Kolkata',\n                    weekday: 'short'\n                })} ${d.mmLow}-${d.mmHigh} mm`).join(', ')}`,\n            'INSTRUCTIONS: respond in json. If NOW strong, lead with NOW; else TODAY. Use exact numbers; one short safety tip only if heavy/very heavy. Hashtags: #TelanganaWeather and #HyderabadRains only for Hyderabad. End with source tag. Keep <= 280 chars.'\n        ].join('\\n');\n        const ai = await (0,_lib_tweetFormat__WEBPACK_IMPORTED_MODULE_4__.formatTweetBalajiStyle)(input, isHyd);\n        const sourceTag = data?.now?.radarEtaMin?.from != null ? 'Model+Radar' : 'Model';\n        const fallback = (0,_lib_tweetFormat__WEBPACK_IMPORTED_MODULE_4__.formatTweetFallback)({\n            area: a.name,\n            scope: p.scope,\n            intensity: data?.today?.intensityWordToday || data?.now?.intensityWordNow || 'moderate',\n            etaFrom: data?.now?.radarEtaMin?.from,\n            etaTo: data?.now?.radarEtaMin?.to,\n            mmhLow: data?.now?.mmhLow,\n            mmhHigh: data?.now?.mmhHigh,\n            windowLabel: p.windowLabel || data?.today?.windowLabel,\n            threeLow: data?.today?.threeMmLow,\n            threeHigh: data?.today?.threeMmHigh,\n            source: sourceTag\n        });\n        const finalText = `${ai?.textEn || fallback.textEn}\\n${ai?.textTe || fallback.textTe}\\n${(ai?.hashtags || fallback.hashtags).join(' ')} ${sourceTag ? `(${sourceTag})` : ''}`.trim().slice(0, 280);\n        const postedRes = await (0,_lib_xClient__WEBPACK_IMPORTED_MODULE_3__.postTweet)(finalText);\n        if (postedRes) {\n            posted += 1;\n            await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.tweetLog.create({\n                data: {\n                    areaId: a.id,\n                    scope: p.scope,\n                    bucket: p.bucket,\n                    windowLabel: p.windowLabel || null,\n                    hash: 'unused-hash',\n                    tweetId: postedRes.id\n                }\n            });\n        }\n    }\n    return {\n        posted\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTVEsS0FBS0MsYUFBYUU7WUFDL0JDLFFBQVFaLE1BQU1RLEtBQUtJO1lBQVFDLFNBQVNiLE1BQU1RLEtBQUtLO1lBQy9DUCxhQUFhbkIsRUFBRW1CLFdBQVcsSUFBSU4sTUFBTU8sT0FBT0Q7WUFDM0NpQyxVQUFVdkMsTUFBTU8sT0FBT1E7WUFBWXlCLFdBQVd4QyxNQUFNTyxPQUFPUztZQUMzRHlCLFFBQVFUO1FBQ1Y7UUFDQSxNQUFNVSxZQUFZLEdBQUlYLElBQUlZLFVBQVVWLFNBQVNVLE1BQU0sQ0FBRSxFQUFFLEVBQUdaLElBQUlhLFVBQVVYLFNBQVNXLE1BQU0sQ0FBRSxFQUFFLEVBQUUsQ0FBQ2IsSUFBSWMsWUFBWVosU0FBU1ksUUFBUSxFQUFFZixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUVFLFlBQVksQ0FBQyxDQUFDLEVBQUVBLFVBQVUsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDYyxJQUFJLEdBQUcxQixLQUFLLENBQUMsR0FBRztRQUNsTSxNQUFNMkIsWUFBWSxNQUFNckUsdURBQVNBLENBQUNnRTtRQUNsQyxJQUFJSyxXQUFXO1lBQ2IvRCxVQUFVO1lBQ1YsTUFBTVIsMkNBQU1BLENBQUN3RSxRQUFRLENBQUNDLE1BQU0sQ0FBQztnQkFBRWpELE1BQU07b0JBQUVQLFFBQVFMLEVBQUVJLEVBQUU7b0JBQUUwQyxPQUFPL0MsRUFBRStDLEtBQUs7b0JBQUVnQixRQUFRL0QsRUFBRStELE1BQU07b0JBQUU1QyxhQUFhbkIsRUFBRW1CLFdBQVcsSUFBSTtvQkFBTTZDLE1BQU07b0JBQWVDLFNBQVNMLFVBQVV2RCxFQUFFO2dCQUFDO1lBQVM7UUFDakw7SUFDRjtJQUNBLE9BQU87UUFBRVI7SUFBTztBQUNsQiIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbGFuZ2FuYS13ZWF0aGVyLWxpdmUvLi9qb2JzL3R3ZWV0UnVubmVyLnRzPzIzYWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjaWRlVHdlZXRzIH0gZnJvbSAnQC9qb2JzL3R3ZWV0RGVjaWRlcic7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9kYic7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICdAL2xpYi9jb25maWcnO1xuaW1wb3J0IHsgcG9zdFR3ZWV0IH0gZnJvbSAnQC9saWIveENsaWVudCc7XG5pbXBvcnQgeyBmb3JtYXRUd2VldEJhbGFqaVN0eWxlLCBmb3JtYXRUd2VldEZhbGxiYWNrIH0gZnJvbSAnQC9saWIvdHdlZXRGb3JtYXQnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuVHdlZXRSdW5uZXIoYXJlYUlkcz86IHN0cmluZ1tdKSB7XG4gIGlmICghY29uZmlnLnR3ZWV0RW5hYmxlKSByZXR1cm4geyBwb3N0ZWQ6IDAsIHNraXBwZWQ6ICdkaXNhYmxlZCcgfTtcbiAgY29uc3QgcGlja3MgPSBhd2FpdCBkZWNpZGVUd2VldHMoYXJlYUlkcyk7XG4gIGxldCBwb3N0ZWQgPSAwO1xuICBmb3IgKGNvbnN0IHAgb2YgcGlja3MpIHtcbiAgICBjb25zdCBhID0gYXdhaXQgcHJpc21hLmFyZWEuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkOiBwLmFyZWFJZCB9IH0pO1xuICAgIGlmICghYSkgY29udGludWU7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQkFTRV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCd9L2FwaS9hcmVhcy8ke2EuaWR9YCwgeyBjYWNoZTogJ25vLXN0b3JlJyB9KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICBjb25zdCBpc0h5ZCA9IC9IeWRlcmFiYWQvaS50ZXN0KGEubmFtZSk7XG4gICAgLy8gQnVpbGQgaW5wdXQgdGV4dCBmb3IgQUlcbiAgICBjb25zdCBpbnB1dCA9IFtcbiAgICAgIGBBUkVBOiAke2EubmFtZX1gLFxuICAgICAgYFdIRU5fTE9DQUw6ICR7cC53aW5kb3dMYWJlbCB8fCBkYXRhPy50b2RheT8ud2luZG93TGFiZWwgfHwgJyd9IElTVGAsXG4gICAgICBgTk9XOiBldGE9JHtkYXRhPy5ub3c/LnJhZGFyRXRhTWluID8gYCR7ZGF0YS5ub3cucmFkYXJFdGFNaW4uZnJvbX0tJHtkYXRhLm5vdy5yYWRhckV0YU1pbi50b31gIDogJ25vbmUnfTsgbW1oPSR7ZGF0YT8ubm93ID8gYCR7ZGF0YS5ub3cubW1oTG93fS0ke2RhdGEubm93Lm1taEhpZ2h9YCA6ICdub25lJ307IHRodW5kZXI9JHtkYXRhPy5ub3c/LnRodW5kZXJGbGFnID8gJ3RydWUnIDogJ2ZhbHNlJ31gLFxuICAgICAgYFRPREFZOiB0b3RhbDNoPSR7ZGF0YT8udG9kYXkgPyBgJHtkYXRhLnRvZGF5LnRocmVlTW1Mb3d9LSR7ZGF0YS50b2RheS50aHJlZU1tSGlnaH0gbW1gIDogJ25vbmUnfTsgaW50ZW5zaXR5PSR7ZGF0YT8udG9kYXk/LmludGVuc2l0eVdvcmRUb2RheSB8fCAnbm9uZSd9OyBwcm9iPSR7ZGF0YT8udG9kYXk/Lm1heFByb2IxMmggPz8gMH0lYCxcbiAgICAgIGBXRUVLX1RPUDI6ICR7KGRhdGE/LndlZWsgfHwgW10pLnNsaWNlKDAsMikubWFwKChkOmFueSkgPT4gYCR7bmV3IERhdGUoZC5kYXRlKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUlOJyx7dGltZVpvbmU6J0FzaWEvS29sa2F0YScsd2Vla2RheTonc2hvcnQnfSl9ICR7ZC5tbUxvd30tJHtkLm1tSGlnaH0gbW1gKS5qb2luKCcsICcpfWAsXG4gICAgICAnSU5TVFJVQ1RJT05TOiByZXNwb25kIGluIGpzb24uIElmIE5PVyBzdHJvbmcsIGxlYWQgd2l0aCBOT1c7IGVsc2UgVE9EQVkuIFVzZSBleGFjdCBudW1iZXJzOyBvbmUgc2hvcnQgc2FmZXR5IHRpcCBvbmx5IGlmIGhlYXZ5L3ZlcnkgaGVhdnkuIEhhc2h0YWdzOiAjVGVsYW5nYW5hV2VhdGhlciBhbmQgI0h5ZGVyYWJhZFJhaW5zIG9ubHkgZm9yIEh5ZGVyYWJhZC4gRW5kIHdpdGggc291cmNlIHRhZy4gS2VlcCA8PSAyODAgY2hhcnMuJ1xuICAgIF0uam9pbignXFxuJyk7XG5cbiAgICBjb25zdCBhaSA9IGF3YWl0IGZvcm1hdFR3ZWV0QmFsYWppU3R5bGUoaW5wdXQsIGlzSHlkKTtcbiAgICBjb25zdCBzb3VyY2VUYWcgPSBkYXRhPy5ub3c/LnJhZGFyRXRhTWluPy5mcm9tICE9IG51bGwgPyAnTW9kZWwrUmFkYXInIDogJ01vZGVsJztcbiAgICBjb25zdCBmYWxsYmFjayA9IGZvcm1hdFR3ZWV0RmFsbGJhY2soe1xuICAgICAgYXJlYTogYS5uYW1lLFxuICAgICAgc2NvcGU6IHAuc2NvcGUsXG4gICAgICBpbnRlbnNpdHk6IChkYXRhPy50b2RheT8uaW50ZW5zaXR5V29yZFRvZGF5IHx8IGRhdGE/Lm5vdz8uaW50ZW5zaXR5V29yZE5vdyB8fCAnbW9kZXJhdGUnKSxcbiAgICAgIGV0YUZyb206IGRhdGE/Lm5vdz8ucmFkYXJFdGFNaW4/LmZyb20sXG4gICAgICBldGFUbzogZGF0YT8ubm93Py5yYWRhckV0YU1pbj8udG8sXG4gICAgICBtbWhMb3c6IGRhdGE/Lm5vdz8ubW1oTG93LCBtbWhIaWdoOiBkYXRhPy5ub3c/Lm1taEhpZ2gsXG4gICAgICB3aW5kb3dMYWJlbDogcC53aW5kb3dMYWJlbCB8fCBkYXRhPy50b2RheT8ud2luZG93TGFiZWwsXG4gICAgICB0aHJlZUxvdzogZGF0YT8udG9kYXk/LnRocmVlTW1Mb3csIHRocmVlSGlnaDogZGF0YT8udG9kYXk/LnRocmVlTW1IaWdoLFxuICAgICAgc291cmNlOiBzb3VyY2VUYWcgYXMgYW55LFxuICAgIH0pO1xuICAgIGNvbnN0IGZpbmFsVGV4dCA9IGAkeyhhaT8udGV4dEVuIHx8IGZhbGxiYWNrLnRleHRFbil9XFxuJHsoYWk/LnRleHRUZSB8fCBmYWxsYmFjay50ZXh0VGUpfVxcbiR7KGFpPy5oYXNodGFncyB8fCBmYWxsYmFjay5oYXNodGFncykuam9pbignICcpfSAke3NvdXJjZVRhZyA/IGAoJHtzb3VyY2VUYWd9KWAgOiAnJ31gLnRyaW0oKS5zbGljZSgwLCAyODApO1xuICAgIGNvbnN0IHBvc3RlZFJlcyA9IGF3YWl0IHBvc3RUd2VldChmaW5hbFRleHQpO1xuICAgIGlmIChwb3N0ZWRSZXMpIHtcbiAgICAgIHBvc3RlZCArPSAxO1xuICAgICAgYXdhaXQgcHJpc21hLnR3ZWV0TG9nLmNyZWF0ZSh7IGRhdGE6IHsgYXJlYUlkOiBhLmlkLCBzY29wZTogcC5zY29wZSwgYnVja2V0OiBwLmJ1Y2tldCwgd2luZG93TGFiZWw6IHAud2luZG93TGFiZWwgfHwgbnVsbCwgaGFzaDogJ3VudXNlZC1oYXNoJywgdHdlZXRJZDogcG9zdGVkUmVzLmlkIH0gYXMgYW55IH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4geyBwb3N0ZWQgfTtcbn1cblxuXG4iXSwibmFtZXMiOlsiZGVjaWRlVHdlZXRzIiwicHJpc21hIiwiY29uZmlnIiwicG9zdFR3ZWV0IiwiZm9ybWF0VHdlZXRCYWxhamlTdHlsZSIsImZvcm1hdFR3ZWV0RmFsbGJhY2siLCJydW5Ud2VldFJ1bm5lciIsImFyZWFJZHMiLCJ0d2VldEVuYWJsZSIsInBvc3RlZCIsInNraXBwZWQiLCJwaWNrcyIsInAiLCJhIiwiYXJlYSIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwiYXJlYUlkIiwicmVzIiwiZmV0Y2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJjYWNoZSIsImRhdGEiLCJqc29uIiwiaXNIeWQiLCJ0ZXN0IiwibmFtZSIsImlucHV0Iiwid2luZG93TGFiZWwiLCJ0b2RheSIsIm5vdyIsInJhZGFyRXRhTWluIiwiZnJvbSIsInRvIiwibW1oTG93IiwibW1oSGlnaCIsInRodW5kZXJGbGFnIiwidGhyZWVNbUxvdyIsInRocmVlTW1IaWdoIiwiaW50ZW5zaXR5V29yZFRvZGF5IiwibWF4UHJvYjEyaCIsIndlZWsiLCJzbGljZSIsIm1hcCIsImQiLCJEYXRlIiwiZGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInRpbWVab25lIiwid2Vla2RheSIsIm1tTG93IiwibW1IaWdoIiwiam9pbiIsImFpIiwic291cmNlVGFnIiwiZmFsbGJhY2siLCJzY29wZSIsImludGVuc2l0eSIsImludGVuc2l0eVdvcmROb3ciLCJldGFGcm9tIiwiZXRhVG8iLCJ0aHJlZUxvdyIsInRocmVlSGlnaCIsInNvdXJjZSIsImZpbmFsVGV4dCIsInRleHRFbiIsInRleHRUZSIsImhhc2h0YWdzIiwidHJpbSIsInBvc3RlZFJlcyIsInR3ZWV0TG9nIiwiY3JlYXRlIiwiYnVja2V0IiwiaGFzaCIsInR3ZWV0SWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./jobs/tweetRunner.ts\n");

/***/ }),

/***/ "(rsc)/./lib/config.ts":
/*!***********************!*\
  !*** ./lib/config.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config)\n/* harmony export */ });\nconst config = {\n    openAiKey: process.env.OPENAI_API_KEY || '',\n    databaseUrl: process.env.DATABASE_URL || '',\n    redisUrl: process.env.REDIS_URL || 'redis://localhost:6379/0',\n    radarProvider: process.env.RADAR_PROVIDER || 'rainviewer',\n    openMeteoBase: process.env.OPENMETEO_BASE || 'https://api.open-meteo.com/v1/forecast',\n    tsdpsUrl: process.env.TSDPS_SOURCE_URL || '',\n    imdNowcastUrl: process.env.IMD_NOWCAST_URL || '',\n    devIngestToken: process.env.DEV_INGEST_TOKEN || '',\n    useMock: process.env.USE_MOCK === 'true',\n    relaxedRules: process.env.RELAXED_RULES === 'true',\n    aiModel: process.env.OPENAI_MODEL || 'gpt-4o-mini',\n    // Tweeting\n    tweetEnable: process.env.TWEET_ENABLE === 'true',\n    tweetMinGapMin: Number(process.env.TWEET_MIN_GAP_MIN || '60'),\n    tweetDailyBudget: Number(process.env.TWEET_DAILY_BUDGET || '100'),\n    tweetIncludeMedia: process.env.TWEET_INCLUDE_MEDIA === 'true',\n    xApiKey: process.env.X_API_KEY || '',\n    xApiSecret: process.env.X_API_SECRET || '',\n    xAccessToken: process.env.X_ACCESS_TOKEN || '',\n    xAccessSecret: process.env.X_ACCESS_SECRET || '',\n    xAppBearer: process.env.X_APP_BEARER || ''\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTyxNQUFNQSxTQUFTO0lBQ3BCQyxXQUFXQyxRQUFRQyxHQUFHLENBQUNDLGNBQWMsSUFBSTtJQUN6Q0MsYUFBYUgsUUFBUUMsR0FBRyxDQUFDRyxZQUFZLElBQUk7SUFDekNDLFVBQVVMLFFBQVFDLEdBQUcsQ0FBQ0ssU0FBUyxJQUFJO0lBQ25DQyxlQUFlUCxRQUFRQyxHQUFHLENBQUNPLGNBQWMsSUFBSTtJQUM3Q0MsZUFBZVQsUUFBUUMsR0FBRyxDQUFDUyxjQUFjLElBQUk7SUFDN0NDLFVBQVVYLFFBQVFDLEdBQUcsQ0FBQ1csZ0JBQWdCLElBQUk7SUFDMUNDLGVBQWViLFFBQVFDLEdBQUcsQ0FBQ2EsZUFBZSxJQUFJO0lBQzlDQyxnQkFBZ0JmLFFBQVFDLEdBQUcsQ0FBQ2UsZ0JBQWdCLElBQUk7SUFDaERDLFNBQVNqQixRQUFRQyxHQUFHLENBQUNpQixRQUFRLEtBQUs7SUFDbENDLGNBQWNuQixRQUFRQyxHQUFHLENBQUNtQixhQUFhLEtBQUs7SUFDNUNDLFNBQVNyQixRQUFRQyxHQUFHLENBQUNxQixZQUFZLElBQUk7SUFDckMsV0FBVztJQUNYQyxhQUFhdkIsUUFBUUMsR0FBRyxDQUFDdUIsWUFBWSxLQUFLO0lBQzFDQyxnQkFBZ0JDLE9BQU8xQixRQUFRQyxHQUFHLENBQUMwQixpQkFBaUIsSUFBSTtJQUN4REMsa0JBQWtCRixPQUFPMUIsUUFBUUMsR0FBRyxDQUFDNEIsa0JBQWtCLElBQUk7SUFDM0RDLG1CQUFtQjlCLFFBQVFDLEdBQUcsQ0FBQzhCLG1CQUFtQixLQUFLO0lBQ3ZEQyxTQUFTaEMsUUFBUUMsR0FBRyxDQUFDZ0MsU0FBUyxJQUFJO0lBQ2xDQyxZQUFZbEMsUUFBUUMsR0FBRyxDQUFDa0MsWUFBWSxJQUFJO0lBQ3hDQyxjQUFjcEMsUUFBUUMsR0FBRyxDQUFDb0MsY0FBYyxJQUFJO0lBQzVDQyxlQUFldEMsUUFBUUMsR0FBRyxDQUFDc0MsZUFBZSxJQUFJO0lBQzlDQyxZQUFZeEMsUUFBUUMsR0FBRyxDQUFDd0MsWUFBWSxJQUFJO0FBQzFDLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWxhbmdhbmEtd2VhdGhlci1saXZlLy4vbGliL2NvbmZpZy50cz8xMjg1Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG9wZW5BaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVkgfHwgJycsXG4gIGRhdGFiYXNlVXJsOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwgfHwgJycsXG4gIHJlZGlzVXJsOiBwcm9jZXNzLmVudi5SRURJU19VUkwgfHwgJ3JlZGlzOi8vbG9jYWxob3N0OjYzNzkvMCcsXG4gIHJhZGFyUHJvdmlkZXI6IHByb2Nlc3MuZW52LlJBREFSX1BST1ZJREVSIHx8ICdyYWludmlld2VyJyxcbiAgb3Blbk1ldGVvQmFzZTogcHJvY2Vzcy5lbnYuT1BFTk1FVEVPX0JBU0UgfHwgJ2h0dHBzOi8vYXBpLm9wZW4tbWV0ZW8uY29tL3YxL2ZvcmVjYXN0JyxcbiAgdHNkcHNVcmw6IHByb2Nlc3MuZW52LlRTRFBTX1NPVVJDRV9VUkwgfHwgJycsXG4gIGltZE5vd2Nhc3RVcmw6IHByb2Nlc3MuZW52LklNRF9OT1dDQVNUX1VSTCB8fCAnJyxcbiAgZGV2SW5nZXN0VG9rZW46IHByb2Nlc3MuZW52LkRFVl9JTkdFU1RfVE9LRU4gfHwgJycsXG4gIHVzZU1vY2s6IHByb2Nlc3MuZW52LlVTRV9NT0NLID09PSAndHJ1ZScsXG4gIHJlbGF4ZWRSdWxlczogcHJvY2Vzcy5lbnYuUkVMQVhFRF9SVUxFUyA9PT0gJ3RydWUnLFxuICBhaU1vZGVsOiBwcm9jZXNzLmVudi5PUEVOQUlfTU9ERUwgfHwgJ2dwdC00by1taW5pJyxcbiAgLy8gVHdlZXRpbmdcbiAgdHdlZXRFbmFibGU6IHByb2Nlc3MuZW52LlRXRUVUX0VOQUJMRSA9PT0gJ3RydWUnLFxuICB0d2VldE1pbkdhcE1pbjogTnVtYmVyKHByb2Nlc3MuZW52LlRXRUVUX01JTl9HQVBfTUlOIHx8ICc2MCcpLFxuICB0d2VldERhaWx5QnVkZ2V0OiBOdW1iZXIocHJvY2Vzcy5lbnYuVFdFRVRfREFJTFlfQlVER0VUIHx8ICcxMDAnKSxcbiAgdHdlZXRJbmNsdWRlTWVkaWE6IHByb2Nlc3MuZW52LlRXRUVUX0lOQ0xVREVfTUVESUEgPT09ICd0cnVlJyxcbiAgeEFwaUtleTogcHJvY2Vzcy5lbnYuWF9BUElfS0VZIHx8ICcnLFxuICB4QXBpU2VjcmV0OiBwcm9jZXNzLmVudi5YX0FQSV9TRUNSRVQgfHwgJycsXG4gIHhBY2Nlc3NUb2tlbjogcHJvY2Vzcy5lbnYuWF9BQ0NFU1NfVE9LRU4gfHwgJycsXG4gIHhBY2Nlc3NTZWNyZXQ6IHByb2Nlc3MuZW52LlhfQUNDRVNTX1NFQ1JFVCB8fCAnJyxcbiAgeEFwcEJlYXJlcjogcHJvY2Vzcy5lbnYuWF9BUFBfQkVBUkVSIHx8ICcnLFxufTtcblxuXG4iXSwibmFtZXMiOlsiY29uZmlnIiwib3BlbkFpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiZGF0YWJhc2VVcmwiLCJEQVRBQkFTRV9VUkwiLCJyZWRpc1VybCIsIlJFRElTX1VSTCIsInJhZGFyUHJvdmlkZXIiLCJSQURBUl9QUk9WSURFUiIsIm9wZW5NZXRlb0Jhc2UiLCJPUEVOTUVURU9fQkFTRSIsInRzZHBzVXJsIiwiVFNEUFNfU09VUkNFX1VSTCIsImltZE5vd2Nhc3RVcmwiLCJJTURfTk9XQ0FTVF9VUkwiLCJkZXZJbmdlc3RUb2tlbiIsIkRFVl9JTkdFU1RfVE9LRU4iLCJ1c2VNb2NrIiwiVVNFX01PQ0siLCJyZWxheGVkUnVsZXMiLCJSRUxBWEVEX1JVTEVTIiwiYWlNb2RlbCIsIk9QRU5BSV9NT0RFTCIsInR3ZWV0RW5hYmxlIiwiVFdFRVRfRU5BQkxFIiwidHdlZXRNaW5HYXBNaW4iLCJOdW1iZXIiLCJUV0VFVF9NSU5fR0FQX01JTiIsInR3ZWV0RGFpbHlCdWRnZXQiLCJUV0VFVF9EQUlMWV9CVURHRVQiLCJ0d2VldEluY2x1ZGVNZWRpYSIsIlRXRUVUX0lOQ0xVREVfTUVESUEiLCJ4QXBpS2V5IiwiWF9BUElfS0VZIiwieEFwaVNlY3JldCIsIlhfQVBJX1NFQ1JFVCIsInhBY2Nlc3NUb2tlbiIsIlhfQUNDRVNTX1RPS0VOIiwieEFjY2Vzc1NlY3JldCIsIlhfQUNDRVNTX1NFQ1JFVCIsInhBcHBCZWFyZXIiLCJYX0FQUF9CRUFSRVIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        'warn',\n        'error'\n    ]\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThDO0FBRTlDLE1BQU1DLGtCQUFrQkM7QUFFakIsTUFBTUMsU0FDWEYsZ0JBQWdCRSxNQUFNLElBQ3RCLElBQUlILHdEQUFZQSxDQUFDO0lBQ2ZJLEtBQUs7UUFBQztRQUFRO0tBQVE7QUFDeEIsR0FBRztBQUVMLElBQUlDLElBQXFDLEVBQUVKLGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbGFuZ2FuYS13ZWF0aGVyLWxpdmUvLi9saWIvZGIudHM/MWRmMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7IHByaXNtYT86IFByaXNtYUNsaWVudCB9O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID1cbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fFxuICBuZXcgUHJpc21hQ2xpZW50KHtcbiAgICBsb2c6IFsnd2FybicsICdlcnJvciddLFxuICB9KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XG5cblxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJsb2ciLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cacheGet: () => (/* binding */ cacheGet),\n/* harmony export */   cacheSet: () => (/* binding */ cacheSet),\n/* harmony export */   redis: () => (/* binding */ redis)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"(rsc)/./node_modules/ioredis/built/index.js\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n\nconst url = process.env.REDIS_URL || 'redis://localhost:6379/0';\n// BullMQ requires maxRetriesPerRequest to be null for blocking connections\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(url, {\n    maxRetriesPerRequest: null,\n    enableReadyCheck: false\n});\nasync function cacheGet(key) {\n    const raw = await redis.get(key);\n    return raw ? JSON.parse(raw) : null;\n}\nasync function cacheSet(key, value, ttlSeconds) {\n    const payload = JSON.stringify(value);\n    if (ttlSeconds) {\n        await redis.set(key, payload, 'EX', ttlSeconds);\n    } else {\n        await redis.set(key, payload);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcmVkaXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBOEI7QUFFOUIsTUFBTUMsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxTQUFTLElBQUk7QUFDckMsMkVBQTJFO0FBQ3BFLE1BQU1DLFFBQVEsSUFBSUwsZ0RBQU9BLENBQUNDLEtBQUs7SUFBRUssc0JBQXNCO0lBQU1DLGtCQUFrQjtBQUFNLEdBQUc7QUFFeEYsZUFBZUMsU0FBWUMsR0FBVztJQUMzQyxNQUFNQyxNQUFNLE1BQU1MLE1BQU1NLEdBQUcsQ0FBQ0Y7SUFDNUIsT0FBT0MsTUFBT0UsS0FBS0MsS0FBSyxDQUFDSCxPQUFhO0FBQ3hDO0FBRU8sZUFBZUksU0FBU0wsR0FBVyxFQUFFTSxLQUFjLEVBQUVDLFVBQW1CO0lBQzdFLE1BQU1DLFVBQVVMLEtBQUtNLFNBQVMsQ0FBQ0g7SUFDL0IsSUFBSUMsWUFBWTtRQUNkLE1BQU1YLE1BQU1jLEdBQUcsQ0FBQ1YsS0FBS1EsU0FBUyxNQUFNRDtJQUN0QyxPQUFPO1FBQ0wsTUFBTVgsTUFBTWMsR0FBRyxDQUFDVixLQUFLUTtJQUN2QjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVsYW5nYW5hLXdlYXRoZXItbGl2ZS8uL2xpYi9yZWRpcy50cz81MWU5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJT1JlZGlzIGZyb20gJ2lvcmVkaXMnO1xuXG5jb25zdCB1cmwgPSBwcm9jZXNzLmVudi5SRURJU19VUkwgfHwgJ3JlZGlzOi8vbG9jYWxob3N0OjYzNzkvMCc7XG4vLyBCdWxsTVEgcmVxdWlyZXMgbWF4UmV0cmllc1BlclJlcXVlc3QgdG8gYmUgbnVsbCBmb3IgYmxvY2tpbmcgY29ubmVjdGlvbnNcbmV4cG9ydCBjb25zdCByZWRpcyA9IG5ldyBJT1JlZGlzKHVybCwgeyBtYXhSZXRyaWVzUGVyUmVxdWVzdDogbnVsbCwgZW5hYmxlUmVhZHlDaGVjazogZmFsc2UgfSk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWNoZUdldDxUPihrZXk6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgY29uc3QgcmF3ID0gYXdhaXQgcmVkaXMuZ2V0KGtleSk7XG4gIHJldHVybiByYXcgPyAoSlNPTi5wYXJzZShyYXcpIGFzIFQpIDogbnVsbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhY2hlU2V0KGtleTogc3RyaW5nLCB2YWx1ZTogdW5rbm93biwgdHRsU2Vjb25kcz86IG51bWJlcikge1xuICBjb25zdCBwYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICBpZiAodHRsU2Vjb25kcykge1xuICAgIGF3YWl0IHJlZGlzLnNldChrZXksIHBheWxvYWQsICdFWCcsIHR0bFNlY29uZHMpO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IHJlZGlzLnNldChrZXksIHBheWxvYWQpO1xuICB9XG59XG5cblxuIl0sIm5hbWVzIjpbIklPUmVkaXMiLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwicmVkaXMiLCJtYXhSZXRyaWVzUGVyUmVxdWVzdCIsImVuYWJsZVJlYWR5Q2hlY2siLCJjYWNoZUdldCIsImtleSIsInJhdyIsImdldCIsIkpTT04iLCJwYXJzZSIsImNhY2hlU2V0IiwidmFsdWUiLCJ0dGxTZWNvbmRzIiwicGF5bG9hZCIsInN0cmluZ2lmeSIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/redis.ts\n");

/***/ }),

/***/ "(rsc)/./lib/tweetFormat.ts":
/*!****************************!*\
  !*** ./lib/tweetFormat.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatTweetBalajiStyle: () => (/* binding */ formatTweetBalajiStyle),\n/* harmony export */   formatTweetFallback: () => (/* binding */ formatTweetFallback)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./lib/config.ts\");\n\n\nconst client = _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.openAiKey ? new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.openAiKey\n}) : null;\nasync function formatTweetBalajiStyle(input, isHyd) {\n    if (!client) return null;\n    const sys = 'You write compact bilingual weather alerts for Telangana. Use the numbers given exactly. Keep total under 280 chars. English first, then Telugu. Use 12 emojis only. Clear and calm tone. Output JSON only with keys: text_en, text_te, hashtags (array).';\n    try {\n        const c = await client.chat.completions.create({\n            model: _lib_config__WEBPACK_IMPORTED_MODULE_0__.config.aiModel,\n            response_format: {\n                type: 'json_object'\n            },\n            temperature: 0.3,\n            messages: [\n                {\n                    role: 'system',\n                    content: sys\n                },\n                {\n                    role: 'user',\n                    content: input + '\\n(Respond in json.)'\n                }\n            ]\n        });\n        const txt = c.choices[0]?.message?.content ?? '';\n        const json = JSON.parse(txt);\n        const hashtags = Array.isArray(json.hashtags) ? json.hashtags : [];\n        const enforced = isHyd ? Array.from(new Set([\n            ...hashtags,\n            '#TelanganaWeather',\n            '#HyderabadRains'\n        ])) : Array.from(new Set([\n            ...hashtags,\n            '#TelanganaWeather'\n        ]));\n        return {\n            textEn: String(json.text_en || ''),\n            textTe: String(json.text_te || ''),\n            hashtags: enforced\n        };\n    } catch  {\n        return null;\n    }\n}\nfunction formatTweetFallback(params) {\n    const { area, scope, intensity, etaFrom, etaTo, mmhLow, mmhHigh, windowLabel, threeLow, threeHigh, source } = params;\n    let enLead = '';\n    if (scope === 'now') {\n        enLead = `${intensity} in ~${etaFrom ?? '?'}${etaTo ?? '?'} min (${mmhLow ?? '?'}${mmhHigh ?? '?'} mm/h).`;\n        if (windowLabel) enLead += ` Window ${windowLabel}.`;\n    } else if (scope === 'today') {\n        enLead = `${intensity} ${threeLow ?? '?'}${threeHigh ?? '?'} mm likely ${windowLabel || 'later today'}.`;\n    } else {\n        enLead = `${intensity} expected this week.`;\n    }\n    const textEn = `${area}: ${enLead} ( ${source} )`.trim();\n    // Simple Telugu mapping\n    const teIntensity = intensity === 'drizzle' ? '' : intensity === 'light' ? '' : intensity === 'moderate' ? '' : intensity === 'heavy' ? '' : ' ';\n    let teLead = '';\n    if (scope === 'now') {\n        teLead = `${teIntensity} ~${etaFrom ?? '?'}${etaTo ?? '?'}  (${mmhLow ?? '?'}${mmhHigh ?? '?'} ./).`;\n        if (windowLabel) teLead += `  ${windowLabel}.`;\n    } else if (scope === 'today') {\n        teLead = `${teIntensity} ${threeLow ?? '?'}${threeHigh ?? '?'} . ${windowLabel || '  '} .`;\n    } else {\n        teLead = `${teIntensity}   .`;\n    }\n    const textTe = `${area}: ${teLead} (${source})`;\n    return {\n        textEn,\n        textTe,\n        hashtags: [\n            '#TelanganaWeather'\n        ]\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdHdlZXRGb3JtYXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0QjtBQUNVO0FBUXRDLE1BQU1FLFNBQVNELCtDQUFNQSxDQUFDRSxTQUFTLEdBQUcsSUFBSUgsOENBQU1BLENBQUM7SUFBRUksUUFBUUgsK0NBQU1BLENBQUNFLFNBQVM7QUFBQyxLQUFLO0FBRXRFLGVBQWVFLHVCQUF1QkMsS0FBYSxFQUFFQyxLQUFjO0lBQ3hFLElBQUksQ0FBQ0wsUUFBUSxPQUFPO0lBQ3BCLE1BQU1NLE1BQU07SUFDWixJQUFJO1FBQ0YsTUFBTUMsSUFBSSxNQUFNUCxPQUFPUSxJQUFJLENBQUNDLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1lBQzdDQyxPQUFPWiwrQ0FBTUEsQ0FBQ2EsT0FBTztZQUNyQkMsaUJBQWlCO2dCQUFFQyxNQUFNO1lBQWM7WUFDdkNDLGFBQWE7WUFDYkMsVUFBVTtnQkFDUjtvQkFBRUMsTUFBTTtvQkFBVUMsU0FBU1o7Z0JBQUk7Z0JBQy9CO29CQUFFVyxNQUFNO29CQUFRQyxTQUFTZCxRQUFRO2dCQUF1QjthQUN6RDtRQUNIO1FBQ0EsTUFBTWUsTUFBTVosRUFBRWEsT0FBTyxDQUFDLEVBQUUsRUFBRUMsU0FBU0gsV0FBVztRQUM5QyxNQUFNSSxPQUFPQyxLQUFLQyxLQUFLLENBQUNMO1FBQ3hCLE1BQU1NLFdBQXFCQyxNQUFNQyxPQUFPLENBQUNMLEtBQUtHLFFBQVEsSUFBSUgsS0FBS0csUUFBUSxHQUFHLEVBQUU7UUFDNUUsTUFBTUcsV0FBV3ZCLFFBQVFxQixNQUFNRyxJQUFJLENBQUMsSUFBSUMsSUFBSTtlQUFJTDtZQUFVO1lBQXFCO1NBQWtCLEtBQUtDLE1BQU1HLElBQUksQ0FBQyxJQUFJQyxJQUFJO2VBQUlMO1lBQVU7U0FBb0I7UUFDM0osT0FBTztZQUFFTSxRQUFRQyxPQUFPVixLQUFLVyxPQUFPLElBQUk7WUFBS0MsUUFBUUYsT0FBT1YsS0FBS2EsT0FBTyxJQUFJO1lBQUtWLFVBQVVHO1FBQVM7SUFDdEcsRUFBRSxPQUFNO1FBQ04sT0FBTztJQUNUO0FBQ0Y7QUFFTyxTQUFTUSxvQkFBb0JDLE1BU25DO0lBQ0MsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsU0FBUyxFQUFFQyxPQUFPLEVBQUVDLEtBQUssRUFBRUMsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLFdBQVcsRUFBRUMsUUFBUSxFQUFFQyxTQUFTLEVBQUVDLE1BQU0sRUFBRSxHQUFHWDtJQUM5RyxJQUFJWSxTQUFTO0lBQ2IsSUFBSVYsVUFBVSxPQUFPO1FBQ25CVSxTQUFTLEdBQUdULFVBQVUsS0FBSyxFQUFFQyxXQUFXLElBQUksQ0FBQyxFQUFFQyxTQUFTLElBQUksTUFBTSxFQUFFQyxVQUFVLElBQUksQ0FBQyxFQUFFQyxXQUFXLElBQUksT0FBTyxDQUFDO1FBQzVHLElBQUlDLGFBQWFJLFVBQVUsQ0FBQyxRQUFRLEVBQUVKLFlBQVksQ0FBQyxDQUFDO0lBQ3RELE9BQU8sSUFBSU4sVUFBVSxTQUFTO1FBQzVCVSxTQUFTLEdBQUdULFVBQVUsQ0FBQyxFQUFFTSxZQUFZLElBQUksQ0FBQyxFQUFFQyxhQUFhLElBQUksV0FBVyxFQUFFRixlQUFlLGNBQWMsQ0FBQyxDQUFDO0lBQzNHLE9BQU87UUFDTEksU0FBUyxHQUFHVCxVQUFVLG9CQUFvQixDQUFDO0lBQzdDO0lBQ0EsTUFBTVQsU0FBUyxHQUFHTyxLQUFLLEVBQUUsRUFBRVcsT0FBTyxHQUFHLEVBQUVELE9BQU8sRUFBRSxDQUFDLENBQUNFLElBQUk7SUFDdEQsd0JBQXdCO0lBQ3hCLE1BQU1DLGNBQWNYLGNBQWMsWUFBWSxZQUFZQSxjQUFjLFVBQVUsVUFBVUEsY0FBYyxhQUFhLFlBQVlBLGNBQWMsVUFBVSxTQUFTO0lBQ3BLLElBQUlZLFNBQVM7SUFDYixJQUFJYixVQUFVLE9BQU87UUFDbkJhLFNBQVMsR0FBR0QsWUFBWSxFQUFFLEVBQUVWLFdBQVcsSUFBSSxDQUFDLEVBQUVDLFNBQVMsSUFBSSxhQUFhLEVBQUVDLFVBQVUsSUFBSSxDQUFDLEVBQUVDLFdBQVcsSUFBSSxXQUFXLENBQUM7UUFDdEgsSUFBSUMsYUFBYU8sVUFBVSxDQUFDLE9BQU8sRUFBRVAsWUFBWSxDQUFDLENBQUM7SUFDckQsT0FBTyxJQUFJTixVQUFVLFNBQVM7UUFDNUJhLFNBQVMsR0FBR0QsWUFBWSxDQUFDLEVBQUVMLFlBQVksSUFBSSxDQUFDLEVBQUVDLGFBQWEsSUFBSSxPQUFPLEVBQUVGLGVBQWUsZ0JBQWdCLFFBQVEsQ0FBQztJQUNsSCxPQUFPO1FBQ0xPLFNBQVMsR0FBR0QsWUFBWSxlQUFlLENBQUM7SUFDMUM7SUFDQSxNQUFNakIsU0FBUyxHQUFHSSxLQUFLLEVBQUUsRUFBRWMsT0FBTyxFQUFFLEVBQUVKLE9BQU8sQ0FBQyxDQUFDO0lBQy9DLE9BQU87UUFBRWpCO1FBQVFHO1FBQVFULFVBQVU7WUFBQztTQUFvQjtJQUFDO0FBQzNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVsYW5nYW5hLXdlYXRoZXItbGl2ZS8uL2xpYi90d2VldEZvcm1hdC50cz9kYmFkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJ0AvbGliL2NvbmZpZyc7XG5cbmV4cG9ydCB0eXBlIFR3ZWV0UGFydHMgPSB7XG4gIHRleHRFbjogc3RyaW5nO1xuICB0ZXh0VGU6IHN0cmluZztcbiAgaGFzaHRhZ3M6IHN0cmluZ1tdO1xufTtcblxuY29uc3QgY2xpZW50ID0gY29uZmlnLm9wZW5BaUtleSA/IG5ldyBPcGVuQUkoeyBhcGlLZXk6IGNvbmZpZy5vcGVuQWlLZXkgfSkgOiBudWxsO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZm9ybWF0VHdlZXRCYWxhamlTdHlsZShpbnB1dDogc3RyaW5nLCBpc0h5ZDogYm9vbGVhbik6IFByb21pc2U8VHdlZXRQYXJ0cyB8IG51bGw+IHtcbiAgaWYgKCFjbGllbnQpIHJldHVybiBudWxsO1xuICBjb25zdCBzeXMgPSAnWW91IHdyaXRlIGNvbXBhY3QgYmlsaW5ndWFsIHdlYXRoZXIgYWxlcnRzIGZvciBUZWxhbmdhbmEuIFVzZSB0aGUgbnVtYmVycyBnaXZlbiBleGFjdGx5LiBLZWVwIHRvdGFsIHVuZGVyIDI4MCBjaGFycy4gRW5nbGlzaCBmaXJzdCwgdGhlbiBUZWx1Z3UuIFVzZSAx4oCTMiBlbW9qaXMgb25seS4gQ2xlYXIgYW5kIGNhbG0gdG9uZS4gT3V0cHV0IEpTT04gb25seSB3aXRoIGtleXM6IHRleHRfZW4sIHRleHRfdGUsIGhhc2h0YWdzIChhcnJheSkuJztcbiAgdHJ5IHtcbiAgICBjb25zdCBjID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiBjb25maWcuYWlNb2RlbCxcbiAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiAnanNvbl9vYmplY3QnIH0sXG4gICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogc3lzIH0sXG4gICAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiBpbnB1dCArICdcXG4oUmVzcG9uZCBpbiBqc29uLiknIH0sXG4gICAgICBdLFxuICAgIH0pO1xuICAgIGNvbnN0IHR4dCA9IGMuY2hvaWNlc1swXT8ubWVzc2FnZT8uY29udGVudCA/PyAnJztcbiAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZSh0eHQpO1xuICAgIGNvbnN0IGhhc2h0YWdzOiBzdHJpbmdbXSA9IEFycmF5LmlzQXJyYXkoanNvbi5oYXNodGFncykgPyBqc29uLmhhc2h0YWdzIDogW107XG4gICAgY29uc3QgZW5mb3JjZWQgPSBpc0h5ZCA/IEFycmF5LmZyb20obmV3IFNldChbLi4uaGFzaHRhZ3MsICcjVGVsYW5nYW5hV2VhdGhlcicsICcjSHlkZXJhYmFkUmFpbnMnXSkpIDogQXJyYXkuZnJvbShuZXcgU2V0KFsuLi5oYXNodGFncywgJyNUZWxhbmdhbmFXZWF0aGVyJ10pKTtcbiAgICByZXR1cm4geyB0ZXh0RW46IFN0cmluZyhqc29uLnRleHRfZW4gfHwgJycpLCB0ZXh0VGU6IFN0cmluZyhqc29uLnRleHRfdGUgfHwgJycpLCBoYXNodGFnczogZW5mb3JjZWQgfTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFR3ZWV0RmFsbGJhY2socGFyYW1zOiB7XG4gIGFyZWE6IHN0cmluZztcbiAgc2NvcGU6ICdub3cnIHwgJ3RvZGF5JyB8ICd3ZWVrJztcbiAgaW50ZW5zaXR5OiBzdHJpbmc7XG4gIGV0YUZyb20/OiBudW1iZXIgfCBudWxsOyBldGFUbz86IG51bWJlciB8IG51bGw7XG4gIG1taExvdz86IG51bWJlciB8IG51bGw7IG1taEhpZ2g/OiBudW1iZXIgfCBudWxsO1xuICB3aW5kb3dMYWJlbD86IHN0cmluZyB8IG51bGw7XG4gIHRocmVlTG93PzogbnVtYmVyIHwgbnVsbDsgdGhyZWVIaWdoPzogbnVtYmVyIHwgbnVsbDtcbiAgc291cmNlOiAnTW9kZWwnIHwgJ01vZGVsK1JhZGFyJztcbn0pOiBUd2VldFBhcnRzIHtcbiAgY29uc3QgeyBhcmVhLCBzY29wZSwgaW50ZW5zaXR5LCBldGFGcm9tLCBldGFUbywgbW1oTG93LCBtbWhIaWdoLCB3aW5kb3dMYWJlbCwgdGhyZWVMb3csIHRocmVlSGlnaCwgc291cmNlIH0gPSBwYXJhbXM7XG4gIGxldCBlbkxlYWQgPSAnJztcbiAgaWYgKHNjb3BlID09PSAnbm93Jykge1xuICAgIGVuTGVhZCA9IGAke2ludGVuc2l0eX0gaW4gfiR7ZXRhRnJvbSA/PyAnPyd94oCTJHtldGFUbyA/PyAnPyd9IG1pbiAoJHttbWhMb3cgPz8gJz8nfeKAkyR7bW1oSGlnaCA/PyAnPyd9IG1tL2gpLmA7XG4gICAgaWYgKHdpbmRvd0xhYmVsKSBlbkxlYWQgKz0gYCBXaW5kb3cgJHt3aW5kb3dMYWJlbH0uYDtcbiAgfSBlbHNlIGlmIChzY29wZSA9PT0gJ3RvZGF5Jykge1xuICAgIGVuTGVhZCA9IGAke2ludGVuc2l0eX0gJHt0aHJlZUxvdyA/PyAnPyd94oCTJHt0aHJlZUhpZ2ggPz8gJz8nfSBtbSBsaWtlbHkgJHt3aW5kb3dMYWJlbCB8fCAnbGF0ZXIgdG9kYXknfS5gO1xuICB9IGVsc2Uge1xuICAgIGVuTGVhZCA9IGAke2ludGVuc2l0eX0gZXhwZWN0ZWQgdGhpcyB3ZWVrLmA7XG4gIH1cbiAgY29uc3QgdGV4dEVuID0gYCR7YXJlYX06ICR7ZW5MZWFkfSAoICR7c291cmNlfSApYC50cmltKCk7XG4gIC8vIFNpbXBsZSBUZWx1Z3UgbWFwcGluZ1xuICBjb25zdCB0ZUludGVuc2l0eSA9IGludGVuc2l0eSA9PT0gJ2RyaXp6bGUnID8gJ+CwnOCwsuCxjeCwsuCxgeCwsuCxgScgOiBpbnRlbnNpdHkgPT09ICdsaWdodCcgPyAn4LCk4LGH4LCy4LC/4LCVJyA6IGludGVuc2l0eSA9PT0gJ21vZGVyYXRlJyA/ICfgsK7gsYvgsLjgsY3gsKTgsLDgsYEnIDogaW50ZW5zaXR5ID09PSAnaGVhdnknID8gJ+CwreCwvuCwsOCxgCcgOiAn4LCF4LCk4LGN4LCv4LCC4LCkIOCwreCwvuCwsOCxgCc7XG4gIGxldCB0ZUxlYWQgPSAnJztcbiAgaWYgKHNjb3BlID09PSAnbm93Jykge1xuICAgIHRlTGVhZCA9IGAke3RlSW50ZW5zaXR5fSB+JHtldGFGcm9tID8/ICc/J33igJMke2V0YVRvID8/ICc/J30g4LCo4LC/4LCu4LC/4LC34LC+4LCy4LGN4LCy4LGLICgke21taExvdyA/PyAnPyd94oCTJHttbWhIaWdoID8/ICc/J30g4LCu4LC/LuCwruCxgC/gsJfgsIIpLmA7XG4gICAgaWYgKHdpbmRvd0xhYmVsKSB0ZUxlYWQgKz0gYCDgsLXgsL/gsILgsKHgsYsgJHt3aW5kb3dMYWJlbH0uYDtcbiAgfSBlbHNlIGlmIChzY29wZSA9PT0gJ3RvZGF5Jykge1xuICAgIHRlTGVhZCA9IGAke3RlSW50ZW5zaXR5fSAke3RocmVlTG93ID8/ICc/J33igJMke3RocmVlSGlnaCA/PyAnPyd9IOCwruCwvy7gsK7gsYAgJHt3aW5kb3dMYWJlbCB8fCAn4LCIIOCwsOCxi+CwnOCxgSDgsKTgsLDgsYHgsLXgsL7gsKQnfSDgsIXgsLXgsJXgsL7gsLbgsIIuYDtcbiAgfSBlbHNlIHtcbiAgICB0ZUxlYWQgPSBgJHt0ZUludGVuc2l0eX0g4LCIIOCwteCwvuCwsOCwgiDgsIXgsLXgsJXgsL7gsLbgsIIuYDtcbiAgfVxuICBjb25zdCB0ZXh0VGUgPSBgJHthcmVhfTogJHt0ZUxlYWR9ICgke3NvdXJjZX0pYDtcbiAgcmV0dXJuIHsgdGV4dEVuLCB0ZXh0VGUsIGhhc2h0YWdzOiBbJyNUZWxhbmdhbmFXZWF0aGVyJ10gfTtcbn1cblxuXG4iXSwibmFtZXMiOlsiT3BlbkFJIiwiY29uZmlnIiwiY2xpZW50Iiwib3BlbkFpS2V5IiwiYXBpS2V5IiwiZm9ybWF0VHdlZXRCYWxhamlTdHlsZSIsImlucHV0IiwiaXNIeWQiLCJzeXMiLCJjIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJhaU1vZGVsIiwicmVzcG9uc2VfZm9ybWF0IiwidHlwZSIsInRlbXBlcmF0dXJlIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsInR4dCIsImNob2ljZXMiLCJtZXNzYWdlIiwianNvbiIsIkpTT04iLCJwYXJzZSIsImhhc2h0YWdzIiwiQXJyYXkiLCJpc0FycmF5IiwiZW5mb3JjZWQiLCJmcm9tIiwiU2V0IiwidGV4dEVuIiwiU3RyaW5nIiwidGV4dF9lbiIsInRleHRUZSIsInRleHRfdGUiLCJmb3JtYXRUd2VldEZhbGxiYWNrIiwicGFyYW1zIiwiYXJlYSIsInNjb3BlIiwiaW50ZW5zaXR5IiwiZXRhRnJvbSIsImV0YVRvIiwibW1oTG93IiwibW1oSGlnaCIsIndpbmRvd0xhYmVsIiwidGhyZWVMb3ciLCJ0aHJlZUhpZ2giLCJzb3VyY2UiLCJlbkxlYWQiLCJ0cmltIiwidGVJbnRlbnNpdHkiLCJ0ZUxlYWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/tweetFormat.ts\n");

/***/ }),

/***/ "(rsc)/./lib/tweetRules.ts":
/*!***************************!*\
  !*** ./lib/tweetRules.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   makeHash: () => (/* binding */ makeHash),\n/* harmony export */   shouldTweetNow: () => (/* binding */ shouldTweetNow),\n/* harmony export */   shouldTweetToday: () => (/* binding */ shouldTweetToday),\n/* harmony export */   shouldTweetWeek: () => (/* binding */ shouldTweetWeek)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction shouldTweetNow(now) {\n    if (!now) return false;\n    const eta = now.radarEtaMin;\n    if (eta && eta.from != null && eta.from <= 90) return true;\n    if ((now.mmhHigh ?? 0) >= 0.5) return true;\n    if (now.thunderFlag) return true;\n    return false;\n}\nfunction shouldTweetToday(today) {\n    if (!today) return false;\n    const prob = today.maxProb12h ?? 0;\n    const okInt = [\n        'moderate',\n        'heavy',\n        'very heavy'\n    ].includes((today.intensityWordToday || '').toLowerCase());\n    if (!(prob >= 70 && okInt)) return false;\n    // window starts within next 9h: we only have a label; assume yes\n    return true;\n}\nfunction shouldTweetWeek(week) {\n    if (!Array.isArray(week)) return false;\n    return week.some((d)=>d.mmHigh >= 15);\n}\nfunction makeHash(areaId, scope, bucket, windowLabel) {\n    const h = node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('sha1');\n    h.update(`${areaId}|${scope}|${bucket}|${windowLabel || ''}`);\n    return h.digest('hex');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdHdlZXRSdWxlcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBaUM7QUFrQjFCLFNBQVNDLGVBQWVDLEdBQWdDO0lBQzdELElBQUksQ0FBQ0EsS0FBSyxPQUFPO0lBQ2pCLE1BQU1DLE1BQU1ELElBQUlFLFdBQVc7SUFDM0IsSUFBSUQsT0FBT0EsSUFBSUUsSUFBSSxJQUFJLFFBQVFGLElBQUlFLElBQUksSUFBSSxJQUFJLE9BQU87SUFDdEQsSUFBSSxDQUFDSCxJQUFJSSxPQUFPLElBQUksTUFBTSxLQUFLLE9BQU87SUFDdEMsSUFBSUosSUFBSUssV0FBVyxFQUFFLE9BQU87SUFDNUIsT0FBTztBQUNUO0FBRU8sU0FBU0MsaUJBQWlCQyxLQUFvQztJQUNuRSxJQUFJLENBQUNBLE9BQU8sT0FBTztJQUNuQixNQUFNQyxPQUFPRCxNQUFNRSxVQUFVLElBQUk7SUFDakMsTUFBTUMsUUFBUTtRQUFDO1FBQVk7UUFBUztLQUFhLENBQUNDLFFBQVEsQ0FBQyxDQUFDSixNQUFNSyxrQkFBa0IsSUFBSSxFQUFDLEVBQUdDLFdBQVc7SUFDdkcsSUFBSSxDQUFFTCxDQUFBQSxRQUFRLE1BQU1FLEtBQUksR0FBSSxPQUFPO0lBQ25DLGlFQUFpRTtJQUNqRSxPQUFPO0FBQ1Q7QUFFTyxTQUFTSSxnQkFBZ0JDLElBQWtDO0lBQ2hFLElBQUksQ0FBQ0MsTUFBTUMsT0FBTyxDQUFDRixPQUFPLE9BQU87SUFDakMsT0FBT0EsS0FBS0csSUFBSSxDQUFDLENBQUNDLElBQU1BLEVBQUVDLE1BQU0sSUFBSTtBQUN0QztBQUVPLFNBQVNDLFNBQVNDLE1BQWMsRUFBRUMsS0FBWSxFQUFFQyxNQUFjLEVBQUVDLFdBQXNDO0lBQzNHLE1BQU1DLElBQUk1Qiw2REFBaUIsQ0FBQztJQUM1QjRCLEVBQUVFLE1BQU0sQ0FBQyxHQUFHTixPQUFPLENBQUMsRUFBRUMsTUFBTSxDQUFDLEVBQUVDLE9BQU8sQ0FBQyxFQUFFQyxlQUFlLElBQUk7SUFDNUQsT0FBT0MsRUFBRUcsTUFBTSxDQUFDO0FBQ2xCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVsYW5nYW5hLXdlYXRoZXItbGl2ZS8uL2xpYi90d2VldFJ1bGVzLnRzP2ExMjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdub2RlOmNyeXB0byc7XG5cbmV4cG9ydCB0eXBlIFNjb3BlID0gJ25vdycgfCAndG9kYXknIHwgJ3dlZWsnO1xuXG5leHBvcnQgdHlwZSBOb3dCbG9jayA9IHtcbiAgcmFkYXJFdGFNaW4/OiB7IGZyb206IG51bWJlciB8IG51bGw7IHRvOiBudW1iZXIgfCBudWxsIH07XG4gIG1taEhpZ2g/OiBudW1iZXI7XG4gIHRodW5kZXJGbGFnPzogYm9vbGVhbjtcbn07XG5cbmV4cG9ydCB0eXBlIFRvZGF5QmxvY2sgPSB7XG4gIG1heFByb2IxMmg/OiBudW1iZXIgfCBudWxsO1xuICBpbnRlbnNpdHlXb3JkVG9kYXk/OiBzdHJpbmcgfCBudWxsO1xuICB3aW5kb3dMYWJlbD86IHN0cmluZyB8IG51bGw7XG59O1xuXG5leHBvcnQgdHlwZSBXZWVrRGF5ID0geyBkYXRlOiBzdHJpbmc7IG1tSGlnaDogbnVtYmVyOyBtYXhQcm9iOiBudW1iZXI7IGludGVuc2l0eVdvcmQ6IHN0cmluZyB9O1xuXG5leHBvcnQgZnVuY3Rpb24gc2hvdWxkVHdlZXROb3cobm93OiBOb3dCbG9jayB8IG51bGwgfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgaWYgKCFub3cpIHJldHVybiBmYWxzZTtcbiAgY29uc3QgZXRhID0gbm93LnJhZGFyRXRhTWluO1xuICBpZiAoZXRhICYmIGV0YS5mcm9tICE9IG51bGwgJiYgZXRhLmZyb20gPD0gOTApIHJldHVybiB0cnVlO1xuICBpZiAoKG5vdy5tbWhIaWdoID8/IDApID49IDAuNSkgcmV0dXJuIHRydWU7XG4gIGlmIChub3cudGh1bmRlckZsYWcpIHJldHVybiB0cnVlO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRUd2VldFRvZGF5KHRvZGF5OiBUb2RheUJsb2NrIHwgbnVsbCB8IHVuZGVmaW5lZCk6IGJvb2xlYW4ge1xuICBpZiAoIXRvZGF5KSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IHByb2IgPSB0b2RheS5tYXhQcm9iMTJoID8/IDA7XG4gIGNvbnN0IG9rSW50ID0gWydtb2RlcmF0ZScsICdoZWF2eScsICd2ZXJ5IGhlYXZ5J10uaW5jbHVkZXMoKHRvZGF5LmludGVuc2l0eVdvcmRUb2RheSB8fCAnJykudG9Mb3dlckNhc2UoKSk7XG4gIGlmICghKHByb2IgPj0gNzAgJiYgb2tJbnQpKSByZXR1cm4gZmFsc2U7XG4gIC8vIHdpbmRvdyBzdGFydHMgd2l0aGluIG5leHQgOWg6IHdlIG9ubHkgaGF2ZSBhIGxhYmVsOyBhc3N1bWUgeWVzXG4gIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvdWxkVHdlZXRXZWVrKHdlZWs6IFdlZWtEYXlbXSB8IG51bGwgfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHdlZWspKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB3ZWVrLnNvbWUoKGQpID0+IGQubW1IaWdoID49IDE1KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VIYXNoKGFyZWFJZDogc3RyaW5nLCBzY29wZTogU2NvcGUsIGJ1Y2tldDogc3RyaW5nLCB3aW5kb3dMYWJlbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyB7XG4gIGNvbnN0IGggPSBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMScpO1xuICBoLnVwZGF0ZShgJHthcmVhSWR9fCR7c2NvcGV9fCR7YnVja2V0fXwke3dpbmRvd0xhYmVsIHx8ICcnfWApO1xuICByZXR1cm4gaC5kaWdlc3QoJ2hleCcpO1xufVxuXG5cbiJdLCJuYW1lcyI6WyJjcnlwdG8iLCJzaG91bGRUd2VldE5vdyIsIm5vdyIsImV0YSIsInJhZGFyRXRhTWluIiwiZnJvbSIsIm1taEhpZ2giLCJ0aHVuZGVyRmxhZyIsInNob3VsZFR3ZWV0VG9kYXkiLCJ0b2RheSIsInByb2IiLCJtYXhQcm9iMTJoIiwib2tJbnQiLCJpbmNsdWRlcyIsImludGVuc2l0eVdvcmRUb2RheSIsInRvTG93ZXJDYXNlIiwic2hvdWxkVHdlZXRXZWVrIiwid2VlayIsIkFycmF5IiwiaXNBcnJheSIsInNvbWUiLCJkIiwibW1IaWdoIiwibWFrZUhhc2giLCJhcmVhSWQiLCJzY29wZSIsImJ1Y2tldCIsIndpbmRvd0xhYmVsIiwiaCIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/tweetRules.ts\n");

/***/ }),

/***/ "(rsc)/./lib/xClient.ts":
/*!************************!*\
  !*** ./lib/xClient.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   postTweet: () => (/* binding */ postTweet)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./lib/config.ts\");\n\nasync function postTweet(text) {\n    if (!_lib_config__WEBPACK_IMPORTED_MODULE_0__.config.tweetEnable) return null;\n    // Placeholder: in real use, use an X client lib or sign request with OAuth 1.0a/2.0\n    // For now, treat as dry-run when keys missing\n    if (!_lib_config__WEBPACK_IMPORTED_MODULE_0__.config.xApiKey || !_lib_config__WEBPACK_IMPORTED_MODULE_0__.config.xApiSecret || !_lib_config__WEBPACK_IMPORTED_MODULE_0__.config.xAccessToken || !_lib_config__WEBPACK_IMPORTED_MODULE_0__.config.xAccessSecret) {\n        console.log('[tweet][dry]', text);\n        return null;\n    }\n    try {\n        // TODO: integrate actual X API client; for MVP we log\n        console.log('[tweet][live]', text);\n        return {\n            id: String(Date.now())\n        };\n    } catch (e) {\n        console.error('tweet error', e);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIveENsaWVudC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFzQztBQUUvQixlQUFlQyxVQUFVQyxJQUFZO0lBQzFDLElBQUksQ0FBQ0YsK0NBQU1BLENBQUNHLFdBQVcsRUFBRSxPQUFPO0lBQ2hDLG9GQUFvRjtJQUNwRiw4Q0FBOEM7SUFDOUMsSUFBSSxDQUFDSCwrQ0FBTUEsQ0FBQ0ksT0FBTyxJQUFJLENBQUNKLCtDQUFNQSxDQUFDSyxVQUFVLElBQUksQ0FBQ0wsK0NBQU1BLENBQUNNLFlBQVksSUFBSSxDQUFDTiwrQ0FBTUEsQ0FBQ08sYUFBYSxFQUFFO1FBQzFGQyxRQUFRQyxHQUFHLENBQUMsZ0JBQWdCUDtRQUM1QixPQUFPO0lBQ1Q7SUFDQSxJQUFJO1FBQ0Ysc0RBQXNEO1FBQ3RETSxRQUFRQyxHQUFHLENBQUMsaUJBQWlCUDtRQUM3QixPQUFPO1lBQUVRLElBQUlDLE9BQU9DLEtBQUtDLEdBQUc7UUFBSTtJQUNsQyxFQUFFLE9BQU9DLEdBQUc7UUFDVk4sUUFBUU8sS0FBSyxDQUFDLGVBQWVEO1FBQzdCLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVsYW5nYW5hLXdlYXRoZXItbGl2ZS8uL2xpYi94Q2xpZW50LnRzP2VlNDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnQC9saWIvY29uZmlnJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvc3RUd2VldCh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPHsgaWQ6IHN0cmluZyB9IHwgbnVsbD4ge1xuICBpZiAoIWNvbmZpZy50d2VldEVuYWJsZSkgcmV0dXJuIG51bGw7XG4gIC8vIFBsYWNlaG9sZGVyOiBpbiByZWFsIHVzZSwgdXNlIGFuIFggY2xpZW50IGxpYiBvciBzaWduIHJlcXVlc3Qgd2l0aCBPQXV0aCAxLjBhLzIuMFxuICAvLyBGb3Igbm93LCB0cmVhdCBhcyBkcnktcnVuIHdoZW4ga2V5cyBtaXNzaW5nXG4gIGlmICghY29uZmlnLnhBcGlLZXkgfHwgIWNvbmZpZy54QXBpU2VjcmV0IHx8ICFjb25maWcueEFjY2Vzc1Rva2VuIHx8ICFjb25maWcueEFjY2Vzc1NlY3JldCkge1xuICAgIGNvbnNvbGUubG9nKCdbdHdlZXRdW2RyeV0nLCB0ZXh0KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICB0cnkge1xuICAgIC8vIFRPRE86IGludGVncmF0ZSBhY3R1YWwgWCBBUEkgY2xpZW50OyBmb3IgTVZQIHdlIGxvZ1xuICAgIGNvbnNvbGUubG9nKCdbdHdlZXRdW2xpdmVdJywgdGV4dCk7XG4gICAgcmV0dXJuIHsgaWQ6IFN0cmluZyhEYXRlLm5vdygpKSB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5lcnJvcigndHdlZXQgZXJyb3InLCBlKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5cbiJdLCJuYW1lcyI6WyJjb25maWciLCJwb3N0VHdlZXQiLCJ0ZXh0IiwidHdlZXRFbmFibGUiLCJ4QXBpS2V5IiwieEFwaVNlY3JldCIsInhBY2Nlc3NUb2tlbiIsInhBY2Nlc3NTZWNyZXQiLCJjb25zb2xlIiwibG9nIiwiaWQiLCJTdHJpbmciLCJEYXRlIiwibm93IiwiZSIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/xClient.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/next","vendor-chunks/ioredis","vendor-chunks/form-data-encoder","vendor-chunks/whatwg-url","vendor-chunks/debug","vendor-chunks/agentkeepalive","vendor-chunks/redis-errors","vendor-chunks/tr46","vendor-chunks/standard-as-callback","vendor-chunks/redis-parser","vendor-chunks/@ioredis","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/supports-color","vendor-chunks/ms","vendor-chunks/lodash.isarguments","vendor-chunks/lodash.defaults","vendor-chunks/humanize-ms","vendor-chunks/has-flag","vendor-chunks/event-target-shim","vendor-chunks/denque","vendor-chunks/cluster-key-slot","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftweet%2Ftrigger%2Froute&page=%2Fapi%2Ftweet%2Ftrigger%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftweet%2Ftrigger%2Froute.ts&appDir=%2FUsers%2Fmohithdonthu%2FWeatherman%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmohithdonthu%2FWeatherman&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();